\documentclass[a4paper,12pt]{article}

% Зачеркивание
\usepackage{cancel}

% Работа с русским языком
\usepackage{cmap}					% Поиск в PDF
\usepackage[T2A]{fontenc}			% Кодировка
\usepackage[utf8]{inputenc}			% Кодировка исходного текста
\usepackage[english,russian]{babel}	% Языки и переносы

%%% Работа с русским языком
% \usepackage[english,russian]{babel}   %% загружает пакет многоязыковой вёрстки
% \usepackage{fontspec}      %% подготавливает загрузку шрифтов Open Type, True Type и др.
% \defaultfontfeatures{Ligatures={TeX},Renderer=Basic}  %% свойства шрифтов по умолчанию
% % \setmainfont[Ligatures={TeX,Historic}]{Times New Roman} %% задаёт основной шрифт документа
% % \setsansfont{Comic Sans MS}                    %% задаёт шрифт без засечек
% % \setmonofont{Courier New}
% % \usepackage{indentfirst}
% % \frenchspacing

 
% Правила переноса
\usepackage{hyphenat}
\hyphenation{ма-те-ма-ти-ка вос-ста-нав-ли-вать}


% Размеры страниц и отступы
\usepackage[a4paper,top=1cm,bottom=2cm,left=2cm,right=1.5cm,marginparwidth=1.75cm]{geometry}

% Дополнительная работа с математикой
\usepackage{amsmath,amsfonts,amssymb,amsthm,mathtools, mathtext, cite, enumerate, float} % Пакеты АМО
\usepackage{icomma} % "Умная" запятая: $0,2$ --- число, $0, 2$ --- перечисление

% Шрифты
\usepackage{euscript}	 % Шрифт Евклид
\usepackage{mathrsfs} % Красивый матшрифт

% Перенос знаков в формулах (по Львовскому)
\newcommand*{\hm}[1]{#1\nobreak\discretionary{}
{\hbox{$\mathsurround=0pt #1$}}{}}

% Работа с картинками
\usepackage{graphicx}  % Для вставки рисунков
\graphicspath{images/}  % Папка с рисунками
\setlength\fboxsep{3pt} % Отступ рамки от рисунка
\setlength\fboxrule{1pt} % Толщина линий рамки
\usepackage{wrapfig} % Обтекание рисунков и таблиц текстом

% Работа с цветами
\usepackage[usenames]{color}
\usepackage{colortbl}

\makeatletter
\renewcommand{\@biblabel}[1]{#1.} % Заменяем библиографию с квадратных скобок на точки
\makeatother

\bibliographystyle{unsrt} % Список источников в порядке упоминания в тексте

% Меняем везде перечисления на цифра.цифра
\renewcommand{\theenumi}{\arabic{enumi}}
\renewcommand{\labelenumi}{\arabic{enumi}}
\renewcommand{\theenumii}{.\arabic{enumii}}
\renewcommand{\labelenumii}{\arabic{enumi}.\arabic{enumii}.}
\renewcommand{\theenumiii}{.\arabic{enumiii}}
\renewcommand{\labelenumiii}{\arabic{enumi}.\arabic{enumii}.\arabic{enumiii}.}


\usepackage{multicol} % Для нескольких уравнений на одной строке

\usepackage[export]{adjustbox} % Для вертикального выравнивания картинки и формулы на одной строке

\newcommand{\expnumber}[2]{{#1}\mathrm{e}{#2}} % Для записи 1e-4

\usepackage{hyperref} % Для цитирования картинок из интернета

\usepackage[nottoc,numbib]{tocbibind} % Список литературы в содержании

% Листинг кода
\usepackage{xcolor}
\usepackage{listings}

\definecolor{mGreen}{rgb}{0,0.6,0}
\definecolor{mGray}{rgb}{0.5,0.5,0.5}
\definecolor{mPurple}{rgb}{0.58,0,0.82}
\definecolor{backgroundColour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{CStyle}{
    backgroundcolor=\color{backgroundColour},   
    commentstyle=\color{mGreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{mGray},
    stringstyle=\color{mPurple},
    basicstyle=\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2,
    language=C
}

\renewcommand{\scriptsize}{\fontsize{14}{14pt}\selectfont}
\usepackage{titlesec}
\titleformat{\section}
{\normalsize\scriptsize\bfseries}
{\thesection}
{1em}{\scriptsize\bfseries}
\titleformat{\subsection}
{\normalsize\scriptsize\bfseries}
{\thesubsection}
{1em}{\scriptsize\bfseries}
\titleformat{\subsubsection}
{\normalsize\scriptsize\bfseries}
{\thesubsubsection}
{1em}{\scriptsize\bfseries}

\title{Неявные по времени численные схемы для расчета многофазных многокомпонентных течений в цифровом керне}
\author{Забегаев Ю.А.}

\begin{document}

%\maketitle
%\newpage

% \begin{titlepage}

% \begin{center}
% Министерство образования и науки Российской Федерации \\
% \vspace{0.5cm}
% Федеральное государственное автономное образовательное учреждение\\
% высшего профессионального образования\\
% «Московский физико-технический институт\\
% (национальный исследовательский университет)»\\
% \vspace{0.5cm}
% Факультет аэрофизики и космических исследований \\
% \vspace{0.5cm}
% Кафедра вычислительной физики \\
% \end{center}

% \vspace{5em}

% \begin{center}
% \Large \textbf{Неявные по времени численные схемы для расчета многофазных многокомпонентных течений в цифровом керне}
% \end{center}

% \vspace{2.5em}

% \begin{center}
% Выпускная квалификационная работа\\
% (бакалаврская работа)
% \end{center}

% \begin{center}
% Направление подготовки 03.03.01 Прикладные математика и физика
% \end{center}

% % \vspace{6em}

% % \begin{flushleft}
% % Заведующий кафедрой \\
% % проф., чл-кор. РАН,
% % д.ф.-м.н. \hrulefill Виноградов Е.А.\\
% % \vspace{1.5em}
% % Научный руководитель \\
% % к.ф.-м.н. \hrulefill Компанец В.О.\\
% % \vspace{1.5em}
% % Рецензент \\
% % к.ф.-м.н. \hrulefill Пойдашев Д.Г.\\
% % \vspace{1.5em}
% % Студент\hrulefill Березутский А.В.
% % \end{flushleft}

% % \vspace{\fill}

% \begin{center}
% Долгопрудный

% \vspace{0.5cm}
% 2020

% \end{center}

% \end{titlepage}

\section*{Аннотация}
Целью данной работы является исследование неявного по времени численного метода моделирования многофазного течения в микромасштабе при помощь гидродинамического метода функционала плотности. На примере трехмерного нелинейного уравнения теплопроводности изучаются подходы к решению нелинейных систем уравнений, возникающих при использовании неявного метода, реализуется вычислительный стенд для сравнения различных подходов в том числе с применением технологии CUDA. Предлагается архитектурное решение на основе библиотек символьной математики для быстрого и эффективного внедрения новых физических моделей жидкостей без изменения кода. Выводится одномерная система гидродинамического метода функционала плотности и предлагается неявная схема для решения. Проводится исследование сеточной сходимости реализованных численных схем.  На примере изучения зависимости шага по времени неявного метода от максимальной среднемассовой скорости в системе показываются преимущества неявной схемы при определенных режимах течения. Использованные численные методы и архитектурные решения будут положены в основу реализации неявного по времени моделирования многофазных течения в трехмерном поровом пространстве.

\newpage

\tableofcontents

\newpage

\section{Введение}
Настоящая работа посвящена исследованию неявного по времени численного метода моделирования многофазного течения в микромасштабе. Под многофазностью подразумевается течение нескольких несмешиваемых флюидов. Под микромасштабом подразумевается такой масштаб, на котором характерный размер границы между флюидами сопоставим с размером задачи. Для корректного описания системы необходимо учитывать геометрию границы и влияние сил поверхностного натяжения между флюидами.
\par
Моделирование многофазного течения на микромасштабах решает много практических задач. Например, разработка процессов добычи углеводородов включает в себя исследование совместного течения воды, газа и нефти в естественной пористой среде. При бурении скважин для изучения берут пробу породы - керн. Компьютерная томография позволяет получить его цифровую 3D-модель. Разрешаемый размер пор в такой модели будет порядка $10^{-6}$ м.  Исследование свойств течения в керне позволяет подобрать оптимальные методы добычи. Моделирование такого течения может быть быстрее и эффективнее, чем лабораторный эксперимент. 
\par
Для построения системы уравнений, описывающих исследуемые течения, используется гидродинамический метод функционала плотности, рассмотренный в \cite{demyanov, kudinov, dhd_spe}. Данный метод описывает жидкости с помощью непрерывных полей. Фронт границы между жидкостями имеет конечную ширину, где параметры жидкостей меняются резко, но остаются непрерывными. По сравнению с классическим гидродинамическим подходом, рассматривающим границу раздела как фронт нулевой толщины, такой подход обладает некоторыми преимуществами. Появляется возможность единообразно описать движение многофазного течения без введения отдельного уравнения движения для поверхности раздела. Не возникают сложности при учете изменения топологии границы раздела - естественным образом можно моделировать слияние и разделение капель. Поскольку моделируются непрерывные функции, можно использовать более простые численные методы, которые недоступны для разрывных уравнений. В данной работе используются симметричные методы аппроксимации производных, которые были бы менее робастными при разрывных решениях. По этой же причине все решения, вид которых нам неизвестен, должны быть гладкими функциями. Все известные функции, которые используются в полученной системе уравнений, считаются непрерывными и непрерывно дифференцируемыми столько раз, сколько требуется. Для краткости в настоящей работе такие функции будем называть \textbf{гладкими аналитическими функциями}. Здесь термин ''аналитические'' употребляется, чтобы подчеркнуть, что они заданы известными формулами.
\par
Система уравнений, описывающая многофазное течение с учетом влияния сил поверхностного натяжения, полученная с помощью метода функционала плотности имеет вид:
\begin{equation} \label{eq:dhd_system_intro}
\begin{cases}
\frac{\partial n_{i}}{\partial t}+\frac{\partial\left(V_{b}n_{i}\right)}{\partial x_{b}}-\frac{\partial}{\partial x_{b}}\left(P_{i j}\frac{\partial\Phi_{j}}{\partial x_{b}}\right)=\vartheta_{i}^{n}(t,x_{a}) 
\\ \\
\frac {\partial\rho V_{a}} {\partial t} + \frac {\partial} {\partial x_{b}} \left( \rho V_{b}V_{a} - \tau_{ab} \right) + n_i \frac{\partial \Phi_i}{\partial x_a}=\vartheta_{a}^{M}(t,x_{a})
\end{cases}
\end{equation}
Для краткости изложения в данной работе будем называть ее \textbf{системой функционала плотности}. Система решается относительно переменных $n_i$ - мольных плотностей и $V_a$ - среднемассовой скорости. Здесь используются стандартные обозначения для индексов, принятые в других работах по методу функционала плотности. Индексы $i, j$ означают номер компоненты, для которой записано уравнение. Индексы $a, b$ означают проекцию вектора на одну из осей прямоугольной декартовой системы координат в пространстве. Смысл всех используемых функций мы поясним, когда рассмотрим систему подробно в главе \ref{dhd}.
Особое внимание в формуле \eqref{eq:dhd_system_intro} нужно уделить химическому потенциалу $\Phi_i$:
\begin{equation} \label{eq:chemical_potential_intro}
\Phi_i := \frac{\partial f}{\partial n_{i}}+\frac{1}{2}\frac{\partial\nu_{jk}}{\partial n_{i}}\frac{\partial n_{j}}{\partial x_{a}}\frac{\partial n_{k}}{\partial x_{a}}-\frac{\partial}{\partial x_{a}}\left(\nu_{ij}\frac{\partial n_{j}}{\partial x_{a}}\right)
\end{equation}
Здесь $f$ - удельная свободная энергия, а $\nu_{ij}$ - матрица поверхностного натяжения. Как видно, в системе используется 4-я производная $n_i$.
\par
Рассмотрим физические процессы, которые описываются системой функционала плотности. В большинстве решаемых задач их можно классифицировать по характерным скоростям:
\begin{itemize}
\item Медленные - перенос массы
\item Быстрые - процессы, связанные с поверхностным натяжением, например перестроение топологии границы между флюидами
\item Очень быстрые - распространение звуковых волн
\end{itemize}

Так как система моделирует сжимаемые жидкости, среди процессов можно выделить распространение звуковых волн. Мы могли бы пренебречь этим эффектом, поскольку он нас не интересует с практической точки зрения. 
Однако явная схема обязана совершать достаточно маленький шаг по времени, который будет описывать самый быстрый процесс в системе. Это ограничение можно получить при исследовании явной схемы на устойчивость. Оно появляется математически из-за старших производных в системе. Как было показано ранее, в ней присутствуют производные до 4 порядка.
\par
Неявный метод интегрирования по времени лишен такого ограничения. Делая неявные шаги, можно сразу переходить от одного равновесного распределения к другому, усредняя процессы распространения звуковых волн. В работах \cite{kudinov, dhd_spe} реализованы численные методы, позволяющие моделировать многофазное течение на микромасштабе с помощью метода функционала плотности. Они используют явный метод интегрирования по времени. В частности, в работе \cite{kudinov} автор ссылается на недостаточные вычислительные мощности для применения неявного метода. 
\par
Вид гладких аналитических функций $f$ и $\nu_{ij}$ в уравнении \eqref{eq:chemical_potential_intro} определяется физической моделью исследуемых жидкостей. В применяемых на практике моделях они имеют сложный вид. Чтобы использовать такую модель, нужно аналитически вычислить их производные по $n_i$. Для применения неявного метода понадобятся еще и вторые производные. Из-за этого внедрение новых физических моделей в программу становится очень трудоемким. В настоящей работе предложен метод автоматизации этого процесса, не замедляющий расчет.
\par
Целью данной работы является исследование подходов к реализации неявного численного метода решения системы функционала плотности. Анализируются преимущества, которые дает неявный метод. Изучаются характерные особенности и трудности, которые могут стать ''бутылочным горлышком'' в его реализации. Предлагаются способы решения таких трудностей. 
\par
Все методы исследовались сначала на упрощенной задаче - скалярном нелинейном уравнении теплопроводности:
\begin{equation} \label{eq:heat_equation_intro}
\frac{\partial u}{\partial t}+ \frac{\partial }{\partial x_i} \left( \alpha (u) \frac{\partial u}{\partial x_i} \right) = \nu(x_i, t)
\end{equation}
где $\nu(x_i, t)$ и $\alpha(u)$ - гладкие аналитические функции. Данное уравнение имеет структуру, аналогичную структуре системы функционала плотности: первая производная по времени, старшие производные по пространству с нелинейным коэффициентом внутри. Этот путь выбран для последовательного изучения задачи от простого к сложному.
\subsubsection*{}
Работа имеет следующую структуру. 
\par
В главе \ref{methods} рассматриваются численные методы, используемые в настоящей работе. Последовательно изучая их, мы приходим к общему алгоритму неявного решения нелинейной задачи. Многие методы для простоты объясняются на примере уравнения теплопроводности \eqref{eq:heat_equation_intro}. Этот подход выбран для наглядности изложения.
\par 
В главе \ref{implementation} мы рассмотрели практические вопросы реализации алгоритмов в виде программы. Большое внимание уделяется стратегиям тестирования численных схем, позволяющим оперативно локализовать и исправить ошибку, допущенную в программе. Предлагается метод автоматического расчета аналитических производных, позволяющий эффективно внедрять новые физические модели. 
\par
В главе \ref{heat} мы подробно рассматриваем применение методов к уравнению теплопроводности. В рамках данной работы реализованы все методы из главы \ref{methods} для одномерной, двухмерной и трехмерной постановок данного уравнения. Это привело к большому количеству численных экспериментов, проверяющих правильность реализации этих методов и их согласованность друг с другом. Постановки этих экспериментов мало отличаются для разных методов и не вызывают исследовательского интереса в рамках темы данной работы. Поэтому мы не ставим себе задачи перечислить их полностью. Вместо этого мы перечисляем все тесты, которые применяются автоматически при добавлении изменений в код. После этого мы рассматриваем избранные эксперименты по исследованию сходимости для двухмерной и трехмерной численных схем. 
\par
В главе \ref{dhd} описывается в подробностях применение системы функционала плотности. Уравнения преобразованы в сферическую систему координат. Мы решаем систему в рамках сферической симметрии, тем самым численно решается одномерная задача. Перечислены методы автоматического тестирования. Проведено и описано несколько численных экспериментов. Мы проверяем, как неравновесное состояние смеси двух флюидов распадается на несмешиваемые капли. Проводится кросс-валидация численной схемы - результаты сравниваются с другой программой, реализующую ту же самую физическую модель. Исследуется сеточная сходимость реализованной численной схемы. Завершает эту главу исследование зависимости максимального шага по времени от максимальной среднемассовой скорости в задаче.
\par
Завершают работу выводы. В конце приводится список цитируемой литературы. Нумерация рисунков и формул сквозная для всей работы. 

\input{1_methods.tex}
\input{3_implementation.tex}
\input{4_heat.tex}
\input{5_dhd.tex}

\section{Выводы}
В данной работе мы рассмотрели подходы к реализации неявного численного метода решения системы функционала плотности. Все изученные методы сначала были реализованы на упрощенной задаче со схожей структурой --- нелинейном уравнении теплопроводности. Реализованы различные численные схемы, решающие уравнение теплопроводности. Используются одномерная, двумерная и трехмерная постановки задачи. 
\par
Предложена архитектура программы, позволяющая быстро внедрять новые физические модели и исследовать их без необходимости писать программный код. В основе данного подхода использование библиотек символьной математики и генерация нужных формул из уравнений, задаваемых физической моделью. При этом не уменьшается производительность расчета, так как генерируемые формулы встраиваются в код и компилируются. Данный подход реализован для трехмерного уравнения теплопроводности.
\par
Разработка и анализ программы для решения уравнения теплопроводности позволили выделить предпочтительные методы для реализации численного решения системы функционала плотности.
\par
На основе выбранных численных методов и архитектурных решений реализована одномерная неявная численная схема расчета системы функционала плотности. Система переведена в сферические координаты и решается со сферической симметрией. Используются автоматические тесты, проверяющие корректность изменений в программе. Проведено сравнение с другой программой, реализующей ту же самую физическую модель жидкости. Исследована сеточная сходимость.
\par
Проведен численный эксперимент, измеряющий зависимость шага по времени от среднемассовой скорости в неявной схеме системы функционала плотности. На основании данного эксперимента можно сделать следующий вывод.
Шаг по времени неявной схемы может быть на несколько порядков выше, чем шаг по времени явной схемы. При этом чем меньше максимальная среднемассовая скорость в системе, тем больше можно сделать шаг по времени. Эффективное применение неявной схемы возможно для таких течений, где медленный процесс переноса массы преобладает над процессами диффузии.
\par
В дальнейшем мы ставим себе цель реализовать трехмерную реализацию системы функционала плотности по неявному методу в поровом пространстве с использованием выбранных в данной работе численных методов и архитектурных решений.

\newpage
\bibliography{bibliography.bib}
\end{document}